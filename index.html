<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PoPo é»é¤ç³»çµ±</title>
    <!-- å¼•å…¥ React èˆ‡ Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- å¼•å…¥ Babel ç”¨ä¾†è§£æ JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- å¼•å…¥ FontAwesome åœ–ç¤º -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* éš±è—æ²è»¸ä½†ä¿ç•™åŠŸèƒ½ */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 h-screen overflow-hidden">
    <div id="root" class="h-full"></div>

    <script type="text/babel" data-type="module">
        // ==========================================
        // ğŸ”´ ç³»çµ±æ ¸å¿ƒè¨­å®šå€ (Firebase Config)
        // ==========================================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, signInAnonymously, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, query, where, orderBy, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
  apiKey: "AIzaSyDYu_gtcp25wx4S25LubmWSQGRgxLrppy0",
  authDomain: "popo-ordering.firebaseapp.com",
  projectId: "popo-ordering",
  storageBucket: "popo-ordering.firebasestorage.app",
  messagingSenderId: "44845700960",
  appId: "1:44845700960:web:b6fd95203d627cacb67005"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ==========================================
        // 1. è³‡æ–™æ¨¡å‹èˆ‡é…ç½® (Data & Configuration)
        // ==========================================

        // èœå–®åˆ†é¡
        const CATEGORIES = [
            { id: 'hotpot', name: 'å¹¸ç¦é‹ç‰©', icon: 'fa-fire-burner' },
            { id: 'square', name: 'å¹¸ç¦äºŒæ¬¡æ–¹', icon: 'fa-utensils' },
            { id: 'pasta', name: 'ç¾©å¤§åˆ©éºµ/ç„—çƒ¤', icon: 'fa-wheat-awn' },
            { id: 'riceball', name: 'æ™®æ™®é£¯ç³°é¤', icon: 'fa-bowl-rice' },
            { id: 'light', name: 'è¼•é£Ÿç¸½åŒ¯/æ²™æ‹‰', icon: 'fa-leaf' },
            { id: 'fried', name: 'ç‚¸ç‰©/ç”œé»', icon: 'fa-cookie-bite' },
            { id: 'beverage', name: 'å–®é»é£²å“', icon: 'fa-mug-hot' },
        ];

        // é£²å“è³‡æ–™åº« (ç”¨æ–¼å‡ç´šåŠ è³¼)
        const BEVERAGES_DATA = [
            { id: 'b01', name: 'ç¾å¼å’–å•¡', price: 110, temp: 'both' },
            { id: 'b02', name: 'åŸå‘³æ‹¿éµ', price: 130, temp: 'both' },
            { id: 'b03', name: 'ç„¦ç³–æ‹¿éµ', price: 150, temp: 'both' },
            { id: 'b04', name: 'å¡å¸ƒå¥‡è«¾', price: 150, temp: 'both' },
            { id: 'b05', name: 'ç‰¹é¸éŒ«è˜­ç´…èŒ¶', price: 100, temp: 'both' },
            { id: 'b06', name: 'é˜¿è–©å§†ç´…èŒ¶', price: 100, temp: 'both' },
            { id: 'b07', name: 'é¦™æª¸æŸšèŒ¶', price: 100, temp: 'both' },
            { id: 'b08', name: 'éµè§€éŸ³', price: 110, temp: 'both' },
            { id: 'b09', name: 'ä¼¯çˆµç´…èŒ¶', price: 120, temp: 'both' },
            { id: 'b10', name: 'æ´‹ç”˜èŠèŒ¶', price: 150, temp: 'hotOnly' },
            { id: 'b11', name: 'ç‰¹é¸éŒ«è˜­å¥¶èŒ¶', price: 120, temp: 'both' },
            { id: 'b12', name: 'é˜¿è–©å§†å¥¶èŒ¶', price: 120, temp: 'both' },
            { id: 'b13', name: 'éµè§€éŸ³å¥¶èŒ¶', price: 130, temp: 'both' },
            { id: 'b14', name: 'ä¼¯çˆµå¥¶èŒ¶', price: 140, temp: 'both' },
            { id: 'b15', name: 'æ—¥å¼ç„ç±³å¥¶èŒ¶', price: 150, temp: 'both' },
            { id: 'b16', name: 'é˜¿è¯ç”°å¯å¯', price: 150, temp: 'both' },
            { id: 'b17', name: 'ç²¾åŠ›è”¬æœæ±', price: 160, temp: 'iceOnly' },
            { id: 'b18', name: 'å¯Œå£«å±±è˜‹æœç‰›å¥¶', price: 130, temp: 'iceOnly' },
            { id: 'b19', name: 'èœ‚èœœæª¸æª¬', price: 130, temp: 'iceOnly' },
            { id: 'b20', name: 'èŠ­æ¨‚ç•ªèŒ„æ¢…', price: 150, temp: 'iceOnly' },
            { id: 'b21', name: 'é¦™è•‰ç‰›å¥¶', price: 130, temp: 'iceOnly' },
            { id: 'b22', name: 'è‘¡è„å„ªæ ¼é£²', price: 140, temp: 'iceOnly' },
            { id: 'b23', name: 'èŠ’æœå†°æ²™', price: 140, temp: 'iceOnly' },
            { id: 'b24', name: 'æª¸æª¬å„ªæ ¼å†°æ²™', price: 140, temp: 'iceOnly' },
            { id: 'b25', name: 'å·§å…‹åŠ›å¯å¯å†°æ²™', price: 150, temp: 'iceOnly' },
            { id: 'b26', name: 'OREOé¤…ä¹¾å¥¶æ˜”', price: 160, temp: 'iceOnly' },
        ];

        // é™„é¤åŸºæœ¬é£²æ–™
        const BASIC_SIDE_DRINKS = [
            { id: 'bd1', name: 'é¦™æª¸æŸšèŒ¶ (å†·)', price: 0 },
            { id: 'bd2', name: 'é¦™æª¸æŸšèŒ¶ (ç†±)', price: 0 },
            { id: 'bd3', name: 'ç´…èŒ¶ (å†·)', price: 0 },
            { id: 'bd4', name: 'ç´…èŒ¶ (ç†±)', price: 0 },
            { id: 'bd5', name: 'é»‘å’–å•¡ (å†·)', price: 0 },
            { id: 'bd6', name: 'é»‘å’–å•¡ (ç†±)', price: 0 },
        ];

        // å®¢è£½åŒ–é¸é …ç¾¤çµ„
        const MODIFIER_OPTIONS = {
            meat: [
                { id: 'm1', name: 'è±¬è‚‰', price: 0 },
                { id: 'm2', name: 'ç‰›è‚‰', price: 30 },
                { id: 'm3', name: 'æµ·é™¸è±¬', price: 60 },
                { id: 'm4', name: 'æµ·é™¸ç‰›', price: 70 },
            ],
            starch: [
                { id: 's1', name: 'ç™½é£¯', price: 0 },
                { id: 's2', name: 'äº”ç©€é£¯', price: 0 },
                { id: 's3', name: 'å†¬ç²‰', price: 0 },
            ],
            starch_square: [ // å¹¸ç¦äºŒæ¬¡æ–¹çš„ä¸»é£Ÿåªæœ‰å…©ç¨®
                { id: 's1', name: 'ç™½é£¯', price: 0 },
                { id: 's2', name: 'äº”ç©€é£¯', price: 0 },
            ],
            pot_base: [
                { id: 'pb1', name: 'é®®é­šé‹', price: 0 },
                { id: 'pb2', name: 'è”¬èœé‹', price: 0 },
            ],
            sauce: [
                { id: 'sc1', name: 'é’é†¬', price: 0 },
                { id: 'sc2', name: 'ç´…é†¬', price: 0 },
            ],
            noodle: [
                { id: 'n1', name: 'ç´°éºµ', price: 0 },
                { id: 'n2', name: 'å¯¬éºµ', price: 0 },
            ],
            spiciness: [
                { id: 'sp1', name: 'å¤§è¾£', price: 0 },
                { id: 'sp2', name: 'ä¸­è¾£', price: 0 },
                { id: 'sp3', name: 'å°è¾£', price: 0 },
            ]
        };

        // ç”¢å“è³‡æ–™ (Products Data)
        // drinkType: 'set' (å¥—é¤å«é£²å“ï¼Œå‡ç´šåŠåƒ¹) | 'light' (åŠ è³¼åŠåƒ¹) | null (ç„¡é£²å“é¸é …)
        const PRODUCTS_DATA = [
            // 1. å¹¸ç¦é‹ç‰©
            { id: 'h01', categoryId: 'hotpot', name: 'æ—¥å¼æ˜†å¸ƒé‹', price: 330, modifierRules: { meat: true, starch: true }, drinkType: 'set' },
            { id: 'h02', categoryId: 'hotpot', name: 'éŸ“å¼æ³¡èœé‹', price: 330, modifierRules: { meat: true, starch: true }, drinkType: 'set' },
            { id: 'h03', categoryId: 'hotpot', name: 'ç”°åœ’å—ç“œé‹', price: 340, modifierRules: { meat: true, starch: true }, drinkType: 'set' },
            { id: 'h04', categoryId: 'hotpot', name: 'è¾›é¦™éº»è¾£é‹', price: 330, modifierRules: { meat: true, starch: true, spiciness: true }, drinkType: 'set' },
            { id: 'h05', categoryId: 'hotpot', name: 'é¢¨å‘³ç‰›å¥¶é‹', price: 360, modifierRules: { meat: true, starch: true }, drinkType: 'set' },
            { id: 'h06', categoryId: 'hotpot', name: 'ç¾©å¼ç•ªèŒ„é‹', price: 340, modifierRules: { meat: true, starch: true }, drinkType: 'set' },

            // 2. å¹¸ç¦äºŒæ¬¡æ–¹ (ä¸»èœ+å°æ¹¯é‹)
            { id: 'sq01', categoryId: 'square', name: 'èœœæ±ç¢³çƒ¤è±¬è‚‹æ’', price: 490, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq02', categoryId: 'square', name: 'é¦™ç…åšé®­é­š', price: 460, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq03', categoryId: 'square', name: 'ç§˜è£½ç´¹èˆˆé†‰é›', price: 420, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq04', categoryId: 'square', name: 'ç ´å¸ƒå­é±ˆé­š', price: 430, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq05', categoryId: 'square', name: 'ç…§ç‡’æ¾é˜ªè±¬', price: 420, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq06', categoryId: 'square', name: 'å¾·å¼é„‰æ‘è±¬è…³', price: 430, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq07', categoryId: 'square', name: 'æ³•å¼è¿·è¿­é¦™é›è…¿', price: 370, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq08', categoryId: 'square', name: 'æ³°å¼æª¸æª¬é­š', price: 400, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq09', categoryId: 'square', name: 'è”¥çˆ†é‡è‡ç‰›è‚‰', price: 410, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq10', categoryId: 'square', name: 'é›²å—æ¤’éº»é›', price: 380, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },
            { id: 'sq11', categoryId: 'square', name: 'å¦‚æ„è”¬é£Ÿ(å…¨ç´ )', price: 360, modifierRules: { pot_base: true, starch_square: true }, drinkType: 'set' },

            // 3. ç¾©å¤§åˆ©éºµ/ç„—çƒ¤
            { id: 'p01', categoryId: 'pasta', name: 'ç…™ç‡»é´¨èƒ¸ç¾©å¤§åˆ©éºµ', price: 350, modifierRules: { sauce: true, noodle: true }, drinkType: 'set' },
            { id: 'p02', categoryId: 'pasta', name: 'è¿·è¿­é›è…¿ç¾©å¤§åˆ©éºµ', price: 340, modifierRules: { sauce: true, noodle: true }, drinkType: 'set' },
            { id: 'p03', categoryId: 'pasta', name: 'åšåˆ‡è±¬æ’ç¾©å¤§åˆ©éºµ', price: 330, modifierRules: { sauce: true, noodle: true }, drinkType: 'set' },
            { id: 'p04', categoryId: 'pasta', name: 'é¦™è‰è›¤è £ç¾©å¤§åˆ©éºµ', price: 320, modifierRules: { sauce: true, noodle: true }, drinkType: 'set' },
            { id: 'p05', categoryId: 'pasta', name: 'å«©ç…ç‰›è‚‰ç¾©å¤§åˆ©éºµ', price: 350, modifierRules: { sauce: true, noodle: true }, drinkType: 'set' },
            { id: 'p06', categoryId: 'pasta', name: 'ç´ é£Ÿé®®æœç¾©å¤§åˆ©éºµ', price: 320, modifierRules: { sauce: true, noodle: true }, drinkType: 'set' },
            { id: 'r01', categoryId: 'pasta', name: 'åŒˆç‰™åˆ©ç‰›è‚‰ç„—çƒ¤é£¯', price: 360, modifierRules: {}, drinkType: 'set' },
            { id: 'r02', categoryId: 'pasta', name: 'å’–å“©é›æ’ç„—çƒ¤é£¯', price: 340, modifierRules: {}, drinkType: 'set' },
            { id: 'r03', categoryId: 'pasta', name: 'å’–å“©è±¬æ’ç„—çƒ¤é£¯', price: 330, modifierRules: {}, drinkType: 'set' },
            { id: 'r04', categoryId: 'pasta', name: 'è”¬é£Ÿå’–å“©ç„—çƒ¤é£¯', price: 320, modifierRules: {}, drinkType: 'set' },

            // 4. æ™®æ™®é£¯ç³°é¤ (è¦–ç‚º Type B è¼•é£Ÿï¼Œå› ç‚ºçœ‹èµ·ä¾†åƒå¥—é¤ï¼Œé è¨­å«æ¹¯)
            { id: 'rb01', categoryId: 'riceball', name: 'è±¬è‚‹æ’é£¯ç³°é¤', price: 330, modifierRules: {}, drinkType: 'light' }, // ç‰¹è‰²é¤ç³»åˆ—åŠ è³¼åŠåƒ¹
            { id: 'rb02', categoryId: 'riceball', name: 'è¿·è¿­é›è…¿é£¯ç³°é¤', price: 280, modifierRules: {}, drinkType: 'light' },
            { id: 'rb03', categoryId: 'riceball', name: 'é¹½çƒ¤é¯–é­šé£¯ç³°é¤', price: 280, modifierRules: {}, drinkType: 'light' },

            // 5. è¼•é£Ÿ/æ²™æ‹‰ (åŠ è³¼é£²å“åŠåƒ¹)
            { id: 'l01', categoryId: 'light', name: 'ç…§ç‡’ç‰›è‚‰è¼•é£Ÿ', price: 280, modifierRules: {}, drinkType: 'light' },
            { id: 'l02', categoryId: 'light', name: 'é»ƒé‡‘è±¬æ’è¼•é£Ÿ', price: 260, modifierRules: {}, drinkType: 'light' },
            { id: 'l03', categoryId: 'light', name: 'ç…™ç‡»é›è‚‰è¼•é£Ÿ', price: 260, modifierRules: {}, drinkType: 'light' },
            { id: 'l04', categoryId: 'light', name: 'æ«»æ¡ƒé´¨èƒ¸æ²™æ‹‰', price: 240, modifierRules: {}, drinkType: 'light' },
            { id: 'l05', categoryId: 'light', name: 'å­£ç¯€æ°´æœæ²™æ‹‰', price: 220, modifierRules: {}, drinkType: 'light' },
            { id: 'l06', categoryId: 'light', name: 'ç…™ç‡»é›è‚‰æ²™æ‹‰', price: 230, modifierRules: {}, drinkType: 'light' },

            // 6. ç‚¸ç‰©/ç”œé» (ç„¡é£²å“å„ªæƒ é‚è¼¯)
            { id: 'f01', categoryId: 'fried', name: 'é‡‘é»ƒè„†è–¯', price: 100, modifierRules: {}, drinkType: null },
            { id: 'f02', categoryId: 'fried', name: 'é…¥ç‚¸é›ç±³èŠ±', price: 100, modifierRules: {}, drinkType: null },
            { id: 'f03', categoryId: 'fried', name: 'ç¾å‘³çƒ¤é›ç¿…', price: 160, modifierRules: {}, drinkType: null },
            { id: 'f04', categoryId: 'fried', name: 'æ‹›ç‰Œç”œä¸è¾£', price: 100, modifierRules: {}, drinkType: null },
            { id: 'f05', categoryId: 'fried', name: 'ç¾å¼æ´‹è”¥åœˆ', price: 100, modifierRules: {}, drinkType: null },
            { id: 'f06', categoryId: 'fried', name: 'é»‘å¿ƒéº»å‰çƒ', price: 100, modifierRules: {}, drinkType: null },
            { id: 'f07', categoryId: 'fried', name: 'æ™®æ™®ç¶œåˆæ‹¼ç›¤', price: 200, modifierRules: {}, drinkType: null },
            { id: 'd01', categoryId: 'fried', name: 'å†°å¿ƒå¸ƒæœ—å°¼', price: 80, modifierRules: {}, drinkType: null },
            { id: 'd02', categoryId: 'fried', name: 'å­£ç¯€æ°´æœé¬†é¤…', price: 240, modifierRules: {}, drinkType: null },
            { id: 'd03', categoryId: 'fried', name: 'å†°æ·‡æ·‹é¬†é¤…', price: 240, modifierRules: {}, drinkType: null },
            
            // 7. å–®é»é£²å“ (å°‡ BEVERAGES_DATA å±•é–‹åˆ°ç”¢å“åˆ—è¡¨)
            ...BEVERAGES_DATA.map(b => ({
                id: b.id,
                categoryId: 'beverage',
                name: b.name,
                price: b.price,
                modifierRules: { temp: b.temp }, // ç‰¹æ®Šè¦å‰‡ï¼šå†·ç†±
                drinkType: null
            }))
        ];

        // ==========================================
        // 2. React Context & State Management
        // ==========================================
        const MenuContext = React.createContext();

        function MenuProvider({ children }) {
            const [user, setUser] = React.useState(null);
            const [isAdmin, setIsAdmin] = React.useState(false); // ç®¡ç†å“¡æ¨¡å¼é–‹é—œ
            const [cart, setCart] = React.useState(() => {
                const saved = localStorage.getItem('popo_cart');
                return saved ? JSON.parse(saved) : [];
            });
            const [selectedCategory, setSelectedCategory] = React.useState('hotpot');
            const [isCartOpen, setIsCartOpen] = React.useState(false);
            const [customerInfo, setCustomerInfo] = React.useState({ tableNo: '', notes: '' });

            React.useEffect(() => {
                localStorage.setItem('popo_cart', JSON.stringify(cart));
            }, [cart]);

            // ç›£è½ Auth
            React.useEffect(() => {
                const unsubscribe = onAuthStateChanged(auth, (u) => {
                    setUser(u);
                    // ç°¡å–®çš„æ¬Šé™åˆ¤æ–·ï¼šå¦‚æœæ˜¯æ­¤ email å‰‡ç‚ºç®¡ç†å“¡ (æ‚¨å¯ä»¥ä¿®æ”¹é€™è£¡)
                    if (u && u.email === 'admin@popo.com') setIsAdmin(true);
                });
                return () => unsubscribe();
            }, []);

            const addToCart = (item) => {
                setCart(prev => [...prev, { ...item, cartId: Date.now() }]);
                setIsCartOpen(true);
            };

            const removeFromCart = (cartId) => {
                setCart(prev => prev.filter(item => item.cartId !== cartId));
            };

            const clearCart = () => setCart([]);

            const submitOrder = async () => {
                if (cart.length === 0) return alert('è³¼ç‰©è»Šæ˜¯ç©ºçš„');
                if (!customerInfo.tableNo) return alert('è«‹è¼¸å…¥æ¡Œè™Ÿ');
                
                try {
                    await addDoc(collection(db, "orders"), {
                        items: cart,
                        tableNo: customerInfo.tableNo,
                        notes: customerInfo.notes,
                        total: cart.reduce((sum, item) => sum + item.finalPrice, 0),
                        status: 'pending',
                        timestamp: serverTimestamp(),
                        userId: user ? user.uid : 'anonymous',
                        userName: user ? user.displayName : 'Guest'
                    });
                    alert('è¨‚å–®å·²é€å‡ºï¼');
                    clearCart();
                    setIsCartOpen(false);
                } catch (e) {
                    console.error("Error adding document: ", e);
                    alert("é€å‡ºå¤±æ•—: " + e.message);
                }
            };

            return (
                <MenuContext.Provider value={{
                    user, isAdmin, setIsAdmin,
                    cart, addToCart, removeFromCart, clearCart,
                    selectedCategory, setSelectedCategory,
                    isCartOpen, setIsCartOpen,
                    customerInfo, setCustomerInfo,
                    submitOrder
                }}>
                    {children}
                </MenuContext.Provider>
            );
        }

        // ==========================================
        // 3. å…ƒä»¶ï¼šå°è¦½åˆ— (Navbar)
        // ==========================================
        function Navbar() {
            const { cart, setIsCartOpen, isAdmin, setIsAdmin, user } = React.useContext(MenuContext);
            const totalItems = cart.length;

            return (
                <nav className="bg-white shadow-md fixed top-0 w-full z-50 h-16 flex justify-between items-center px-4">
                    <div className="flex items-center gap-2">
                        <div className="w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center text-white font-bold">P</div>
                        <h1 className="text-xl font-bold text-gray-800">PoPo é»é¤</h1>
                    </div>
                    
                    <div className="flex items-center gap-4">
                        <button 
                            onClick={() => setIsAdmin(!isAdmin)}
                            className={`text-xs px-2 py-1 rounded border ${isAdmin ? 'bg-gray-800 text-white' : 'bg-gray-100 text-gray-500'}`}
                        >
                            {isAdmin ? 'å¾Œå°' : 'å‰å°'}
                        </button>

                        <button 
                            className="relative p-2 text-gray-600"
                            onClick={() => setIsCartOpen(true)}
                        >
                            <i className="fa-solid fa-cart-shopping text-xl"></i>
                            {totalItems > 0 && (
                                <span className="absolute top-0 right-0 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full animate-bounce">
                                    {totalItems}
                                </span>
                            )}
                        </button>
                    </div>
                </nav>
            );
        }

        // ==========================================
        // 4. å…ƒä»¶ï¼šåˆ†é¡é¸å–® (CategoryNav)
        // ==========================================
        function CategoryNav() {
            const { selectedCategory, setSelectedCategory } = React.useContext(MenuContext);

            return (
                <div className="fixed top-16 left-0 w-full bg-white border-b z-40 overflow-x-auto scrollbar-hide">
                    <div className="flex px-2 py-2 gap-2 whitespace-nowrap">
                        {CATEGORIES.map(cat => (
                            <button
                                key={cat.id}
                                onClick={() => setSelectedCategory(cat.id)}
                                className={`px-4 py-2 rounded-full text-sm font-medium transition-colors flex items-center gap-2 ${
                                    selectedCategory === cat.id 
                                    ? 'bg-orange-500 text-white shadow-lg transform scale-105' 
                                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                                }`}
                            >
                                <i className={`fa-solid ${cat.icon}`}></i>
                                {cat.name}
                            </button>
                        ))}
                    </div>
                </div>
            );
        }

        // ==========================================
        // 5. å…ƒä»¶ï¼šé¤é»è©³ç´°é¸é … (ItemModal) - æ ¸å¿ƒé‚è¼¯
        // ==========================================
        function ItemModal({ product, onClose, onConfirm }) {
            // åˆå§‹åŒ–ç‹€æ…‹
            const [choices, setChoices] = React.useState({
                meat: null,
                starch: null,
                starch_square: null,
                pot_base: null,
                sauce: null,
                noodle: null,
                spiciness: null,
                drinkMode: 'basic', // basic (é™„é¤) or upgrade (å‡ç´š)
                selectedDrink: null, // ç”¨æ–¼å‡ç´šæˆ–å–®é»
                basicDrink: BASIC_SIDE_DRINKS[0], // é è¨­é™„é¤é£²æ–™
                temp: null // å–®é»é£²å“çš„å†·ç†±
            });

            // è¨ˆç®—ç¸½åƒ¹
            const calculateTotal = () => {
                let total = product.price;

                // 1. åŠ æ–™åƒ¹æ ¼
                if (choices.meat) total += choices.meat.price;
                
                // 2. é£²å“åƒ¹æ ¼é‚è¼¯
                if (product.drinkType === 'set') { // å¥—é¤æ¨¡å¼
                    if (choices.drinkMode === 'upgrade' && choices.selectedDrink) {
                        total += (choices.selectedDrink.price / 2); // å‡ç´šåŠåƒ¹
                    }
                } else if (product.drinkType === 'light') { // è¼•é£Ÿ/åŠ è³¼æ¨¡å¼
                    if (choices.drinkMode === 'upgrade' && choices.selectedDrink) {
                        total += (choices.selectedDrink.price / 2); // åŠ è³¼åŠåƒ¹
                    }
                }
                // å–®é»é£²å“æœ¬èº«ä¸åŠ åƒ¹(å·²å«åœ¨ product.price)ï¼Œåªéœ€ç¢ºèªæ˜¯å¦æœ‰é¸è¦æ ¼
                
                return total;
            };

            const handleConfirm = () => {
                // é©—è­‰å¿…å¡«
                if (product.modifierRules.meat && !choices.meat) return alert('è«‹é¸æ“‡è‚‰å“');
                if (product.modifierRules.starch && !choices.starch) return alert('è«‹é¸æ“‡å‰¯é£Ÿ');
                if (product.modifierRules.pot_base && !choices.pot_base) return alert('è«‹é¸æ“‡æ¹¯åº•');
                if (product.modifierRules.sauce && !choices.sauce) return alert('è«‹é¸æ“‡é†¬æ±');
                if (product.modifierRules.noodle && !choices.noodle) return alert('è«‹é¸æ“‡éºµæ¢');
                
                // é£²å“é©—è­‰
                let drinkDesc = '';
                if (product.drinkType === 'set') {
                    if (choices.drinkMode === 'basic') drinkDesc = choices.basicDrink.name;
                    else if (choices.selectedDrink) drinkDesc = `${choices.selectedDrink.name} (å‡ç´š)`;
                    else return alert('è«‹é¸æ“‡é£²å“');
                } else if (product.drinkType === 'light') {
                    if (choices.drinkMode === 'upgrade') {
                        if (!choices.selectedDrink) return alert('è«‹é¸æ“‡åŠ è³¼é£²å“');
                        drinkDesc = `${choices.selectedDrink.name} (åŠ è³¼)`;
                    } else {
                        drinkDesc = 'ç„¡é£²å“';
                    }
                } else if (product.categoryId === 'beverage') {
                     // å–®é»é£²å“å¦‚æœæœ‰åˆ†å†·ç†±
                     if (product.modifierRules.temp === 'both' && !choices.temp) return alert('è«‹é¸æ“‡å†·ç†±');
                     drinkDesc = choices.temp ? choices.temp : '';
                }

                onConfirm({
                    ...product,
                    finalPrice: calculateTotal(),
                    details: choices,
                    drinkDescription: drinkDesc,
                    specDescription: [
                        choices.meat?.name,
                        choices.starch?.name || choices.starch_square?.name,
                        choices.pot_base?.name,
                        choices.sauce?.name,
                        choices.noodle?.name,
                        choices.spiciness?.name,
                        product.categoryId === 'beverage' ? choices.temp : null
                    ].filter(Boolean).join(', ')
                });
            };

            // æ¸²æŸ“å–®é¸æŒ‰éˆ•ç¾¤çµ„ (Radio Group)
            const renderRadioGroup = (key, title, options) => {
                if (!product.modifierRules[key]) return null;
                return (
                    <div className="mb-4">
                        <h3 className="font-bold mb-2 text-gray-700">{title} <span className="text-red-500">*</span></h3>
                        <div className="grid grid-cols-2 gap-2">
                            {options.map(opt => (
                                <button
                                    key={opt.id}
                                    onClick={() => setChoices(prev => ({ ...prev, [key]: opt }))}
                                    className={`py-2 px-3 rounded border text-sm transition-all ${
                                        choices[key]?.id === opt.id
                                        ? 'bg-orange-100 border-orange-500 text-orange-700 font-bold'
                                        : 'bg-white border-gray-200 text-gray-600'
                                    }`}
                                >
                                    {opt.name} {opt.price > 0 && `(+${opt.price})`}
                                </button>
                            ))}
                        </div>
                    </div>
                );
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end sm:items-center justify-center p-0 sm:p-4">
                    <div className="bg-white w-full sm:max-w-lg h-[90vh] sm:h-auto sm:max-h-[90vh] rounded-t-xl sm:rounded-xl flex flex-col shadow-2xl animate-slide-up">
                        
                        {/* Header */}
                        <div className="p-4 border-b flex justify-between items-center bg-gray-50">
                            <div>
                                <h2 className="text-lg font-bold">{product.name}</h2>
                                <p className="text-orange-600 font-bold text-xl">${calculateTotal()}</p>
                            </div>
                            <button onClick={onClose} className="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center hover:bg-gray-300">âœ•</button>
                        </div>

                        {/* Content Scroll Area */}
                        <div className="flex-1 overflow-y-auto p-4">
                            {/* ä¸€èˆ¬é¸é … */}
                            {renderRadioGroup('pot_base', 'é¸æ“‡é‹åº•', MODIFIER_OPTIONS.pot_base)}
                            {renderRadioGroup('meat', 'é¸æ“‡è‚‰å“', MODIFIER_OPTIONS.meat)}
                            {renderRadioGroup('starch', 'é¸æ“‡å‰¯é£Ÿ', MODIFIER_OPTIONS.starch)}
                            {renderRadioGroup('starch_square', 'é¸æ“‡ä¸»é£Ÿ', MODIFIER_OPTIONS.starch_square)}
                            {renderRadioGroup('sauce', 'é¸æ“‡é†¬æ±', MODIFIER_OPTIONS.sauce)}
                            {renderRadioGroup('noodle', 'é¸æ“‡éºµæ¢', MODIFIER_OPTIONS.noodle)}
                            {renderRadioGroup('spiciness', 'é¸æ“‡è¾£åº¦', MODIFIER_OPTIONS.spiciness)}

                            {/* é£²å“é‚è¼¯å€åŸŸ */}
                            {(product.drinkType === 'set' || product.drinkType === 'light') && (
                                <div className="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-100">
                                    <h3 className="font-bold mb-3 text-blue-800 flex items-center gap-2">
                                        <i className="fa-solid fa-mug-hot"></i> é£²å“é¸æ“‡
                                    </h3>
                                    
                                    {/* æ¨¡å¼åˆ‡æ› Tabs */}
                                    <div className="flex bg-white rounded-lg p-1 mb-4 border shadow-sm">
                                        {product.drinkType === 'set' && (
                                            <button 
                                                className={`flex-1 py-2 text-sm rounded-md font-medium transition ${choices.drinkMode === 'basic' ? 'bg-blue-500 text-white shadow' : 'text-gray-500'}`}
                                                onClick={() => setChoices(prev => ({...prev, drinkMode: 'basic'}))}
                                            >
                                                é™„é¤é£²æ–™ (å…è²»)
                                            </button>
                                        )}
                                        <button 
                                            className={`flex-1 py-2 text-sm rounded-md font-medium transition ${choices.drinkMode === 'upgrade' ? 'bg-blue-500 text-white shadow' : 'text-gray-500'}`}
                                            onClick={() => setChoices(prev => ({...prev, drinkMode: 'upgrade'}))}
                                        >
                                            {product.drinkType === 'set' ? 'å‡ç´šå…¶ä»–é£²å“ (åŠåƒ¹)' : 'åŠ è³¼é£²å“ (åŠåƒ¹)'}
                                        </button>
                                        {product.drinkType === 'light' && (
                                            <button 
                                                className={`flex-1 py-2 text-sm rounded-md font-medium transition ${choices.drinkMode === 'none' ? 'bg-blue-500 text-white shadow' : 'text-gray-500'}`}
                                                onClick={() => setChoices(prev => ({...prev, drinkMode: 'none'}))}
                                            >
                                                ä¸åŠ è³¼
                                            </button>
                                        )}
                                    </div>

                                    {/* é™„é¤é£²æ–™é¸å–® */}
                                    {choices.drinkMode === 'basic' && product.drinkType === 'set' && (
                                        <div className="grid grid-cols-2 gap-2">
                                            {BASIC_SIDE_DRINKS.map(d => (
                                                <button
                                                    key={d.id}
                                                    onClick={() => setChoices(prev => ({ ...prev, basicDrink: d }))}
                                                    className={`py-2 px-2 text-sm rounded border ${choices.basicDrink?.id === d.id ? 'bg-blue-100 border-blue-500 text-blue-700' : 'bg-white'}`}
                                                >
                                                    {d.name}
                                                </button>
                                            ))}
                                        </div>
                                    )}

                                    {/* å‡ç´š/åŠ è³¼é£²æ–™é¸å–® (ä¸‹æ‹‰å¼) */}
                                    {choices.drinkMode === 'upgrade' && (
                                        <div className="space-y-3">
                                            <select 
                                                className="w-full p-3 border rounded-lg bg-white"
                                                onChange={(e) => {
                                                    const drink = BEVERAGES_DATA.find(b => b.id === e.target.value);
                                                    setChoices(prev => ({ ...prev, selectedDrink: drink }));
                                                }}
                                                value={choices.selectedDrink?.id || ''}
                                            >
                                                <option value="" disabled>-- è«‹é¸æ“‡é£²å“ --</option>
                                                {BEVERAGES_DATA.map(b => (
                                                    <option key={b.id} value={b.id}>
                                                        {b.name} (åŸåƒ¹${b.price} âœ åŠ è³¼åƒ¹${b.price/2})
                                                    </option>
                                                ))}
                                            </select>
                                            
                                            {/* é¡¯ç¤ºé¸æ“‡çµæœèˆ‡æº«åº¦é™åˆ¶ */}
                                            {choices.selectedDrink && (
                                                 <div className="text-sm text-gray-500 mt-2">
                                                    æ³¨æ„ï¼šæ­¤é£²å“ä¾›æ‡‰ {choices.selectedDrink.temp === 'both' ? 'å†·/ç†±' : choices.selectedDrink.temp === 'hotOnly' ? 'åƒ…é™ç†±é£²' : 'åƒ…é™å†°é£²'}
                                                 </div>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* å–®é»é£²å“å†·ç†±é¸æ“‡ */}
                            {product.categoryId === 'beverage' && product.modifierRules.temp === 'both' && (
                                <div className="mb-4">
                                    <h3 className="font-bold mb-2">æº«åº¦</h3>
                                    <div className="flex gap-4">
                                        <label className="flex items-center gap-2">
                                            <input type="radio" name="temp" value="å†°" onChange={(e) => setChoices(prev => ({...prev, temp: e.target.value}))} /> å†°
                                        </label>
                                        <label className="flex items-center gap-2">
                                            <input type="radio" name="temp" value="ç†±" onChange={(e) => setChoices(prev => ({...prev, temp: e.target.value}))} /> ç†±
                                        </label>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* Footer Action */}
                        <div className="p-4 border-t bg-white safe-area-bottom">
                            <button 
                                onClick={handleConfirm}
                                className="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-4 rounded-xl shadow-lg transform transition active:scale-95 flex justify-between items-center"
                            >
                                <span>åŠ å…¥è³¼ç‰©è»Š</span>
                                <span>${calculateTotal()}</span>
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // ==========================================
        // 6. å…ƒä»¶ï¼šå‰å°ä¸»ç•«é¢
        // ==========================================
        function CustomerView() {
            const { selectedCategory, addToCart } = React.useContext(MenuContext);
            const [viewingProduct, setViewingProduct] = React.useState(null);

            const displayedProducts = PRODUCTS_DATA.filter(p => p.categoryId === selectedCategory);

            return (
                <div className="pt-32 pb-24 px-4 max-w-5xl mx-auto min-h-screen overflow-y-auto">
                    <h2 className="text-xl font-bold mb-4 text-gray-700 pl-2 border-l-4 border-orange-500">
                        {CATEGORIES.find(c => c.id === selectedCategory)?.name}
                    </h2>
                    
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        {displayedProducts.map(product => (
                            <div 
                                key={product.id} 
                                onClick={() => setViewingProduct(product)}
                                className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center cursor-pointer hover:shadow-md transition"
                            >
                                <div>
                                    <h3 className="font-bold text-lg text-gray-800">{product.name}</h3>
                                    <p className="text-orange-600 font-medium mt-1">${product.price}</p>
                                </div>
                                <button className="w-8 h-8 bg-orange-100 text-orange-500 rounded-full flex items-center justify-center">
                                    <i className="fa-solid fa-plus"></i>
                                </button>
                            </div>
                        ))}
                    </div>

                    {/* å½ˆå‡ºè¦–çª— */}
                    {viewingProduct && (
                        <ItemModal 
                            product={viewingProduct}
                            onClose={() => setViewingProduct(null)}
                            onConfirm={(item) => {
                                addToCart(item);
                                setViewingProduct(null);
                            }}
                        />
                    )}
                </div>
            );
        }

        // ==========================================
        // 7. å…ƒä»¶ï¼šè³¼ç‰©è»Šå´é‚Šæ¬„ (CartSidebar)
        // ==========================================
        function CartSidebar() {
            const { cart, removeFromCart, isCartOpen, setIsCartOpen, customerInfo, setCustomerInfo, submitOrder } = React.useContext(MenuContext);
            const total = cart.reduce((sum, item) => sum + item.finalPrice, 0);

            if (!isCartOpen) return null;

            return (
                <div className="fixed inset-0 z-50 flex justify-end">
                    {/* èƒŒæ™¯é®ç½© */}
                    <div className="absolute inset-0 bg-black bg-opacity-30 backdrop-blur-sm" onClick={() => setIsCartOpen(false)}></div>
                    
                    {/* å´é‚Šæ¬„æœ¬é«” */}
                    <div className="relative bg-white w-full max-w-md h-full shadow-2xl flex flex-col animate-slide-left">
                        <div className="p-4 bg-orange-500 text-white flex justify-between items-center shadow-md">
                            <h2 className="text-lg font-bold"><i className="fa-solid fa-receipt mr-2"></i>è³¼ç‰©è»Š</h2>
                            <button onClick={() => setIsCartOpen(false)} className="text-white hover:text-gray-200">âœ• é—œé–‰</button>
                        </div>

                        {/* é¡§å®¢è³‡è¨Šè¼¸å…¥ */}
                        <div className="p-4 bg-orange-50 border-b">
                            <input 
                                type="text" 
                                placeholder="è«‹è¼¸å…¥æ¡Œè™Ÿ (å¿…å¡«)" 
                                className="w-full p-2 border border-orange-200 rounded mb-2 focus:outline-none focus:ring-2 focus:ring-orange-300"
                                value={customerInfo.tableNo}
                                onChange={e => setCustomerInfo({...customerInfo, tableNo: e.target.value})}
                            />
                            <textarea 
                                placeholder="æ•´å–®å‚™è¨» (é¸å¡«)" 
                                className="w-full p-2 border border-orange-200 rounded text-sm h-16 resize-none focus:outline-none focus:ring-2 focus:ring-orange-300"
                                value={customerInfo.notes}
                                onChange={e => setCustomerInfo({...customerInfo, notes: e.target.value})}
                            ></textarea>
                        </div>

                        {/* è¨‚å–®åˆ—è¡¨ */}
                        <div className="flex-1 overflow-y-auto p-4 space-y-4">
                            {cart.length === 0 ? (
                                <div className="text-center text-gray-400 mt-20">
                                    <i className="fa-solid fa-basket-shopping text-6xl mb-4 opacity-30"></i>
                                    <p>é‚„æ²’æœ‰é»é¤å–”</p>
                                </div>
                            ) : (
                                cart.map(item => (
                                    <div key={item.cartId} className="bg-white border rounded-lg p-3 shadow-sm relative">
                                        <div className="flex justify-between items-start">
                                            <h3 className="font-bold text-gray-800">{item.name}</h3>
                                            <span className="font-mono font-bold text-orange-600">${item.finalPrice}</span>
                                        </div>
                                        <div className="text-xs text-gray-500 mt-1 space-y-1">
                                            {item.specDescription && <p>è¦æ ¼: {item.specDescription}</p>}
                                            {item.drinkDescription && <p className="text-blue-600"><i className="fa-solid fa-mug-hot text-[10px]"></i> {item.drinkDescription}</p>}
                                        </div>
                                        <button 
                                            onClick={() => removeFromCart(item.cartId)}
                                            className="absolute bottom-2 right-2 text-red-400 hover:text-red-600 text-xs px-2 py-1"
                                        >
                                            <i className="fa-solid fa-trash"></i> ç§»é™¤
                                        </button>
                                    </div>
                                ))
                            )}
                        </div>

                        {/* åº•éƒ¨çµå¸³ */}
                        <div className="p-4 border-t bg-gray-50">
                            <div className="flex justify-between items-center mb-4 text-lg font-bold">
                                <span>ç¸½é‡‘é¡</span>
                                <span className="text-orange-600">${total}</span>
                            </div>
                            <button 
                                onClick={submitOrder}
                                className="w-full bg-orange-600 text-white py-3 rounded-xl font-bold hover:bg-orange-700 shadow-lg transition disabled:bg-gray-400"
                                disabled={cart.length === 0}
                            >
                                ç¢ºèªé€å‡ºè¨‚å–®
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // ==========================================
        // 8. å…ƒä»¶ï¼šå¾Œå°ç®¡ç†å„€è¡¨æ¿ (AdminDashboard)
        // ==========================================
        function AdminDashboard() {
            const [orders, setOrders] = React.useState([]);

            React.useEffect(() => {
                // è¨‚é–±è¨‚å–®è®ŠåŒ–
                const q = query(collection(db, "orders"), orderBy("timestamp", "desc"));
                const unsubscribe = onSnapshot(q, (snapshot) => {
                    const orderData = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    setOrders(orderData);
                });
                return () => unsubscribe();
            }, []);

            // åˆªé™¤/å®Œæˆè¨‚å–®
            const completeOrder = async (orderId) => {
                if(!confirm('ç¢ºèªæ­¤è¨‚å–®å·²å®Œæˆä¸¦å°å­˜ï¼Ÿ')) return;
                try {
                    await deleteDoc(doc(db, "orders", orderId));
                } catch (e) {
                    alert("æ“ä½œå¤±æ•—: " + e.message);
                }
            };

            return (
                <div className="pt-20 px-4 max-w-6xl mx-auto min-h-screen bg-gray-100 overflow-y-auto pb-20">
                    <h2 className="text-2xl font-bold mb-6 text-gray-700 border-l-8 border-blue-600 pl-3">
                        å»šæˆ¿ç®¡ç†ç³»çµ± (KDS)
                    </h2>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {orders.map(order => (
                            <div key={order.id} className="bg-white rounded-xl shadow-md border-t-4 border-blue-500 overflow-hidden flex flex-col">
                                <div className="bg-blue-50 p-3 flex justify-between items-center border-b">
                                    <span className="text-xl font-black text-blue-800">æ¡Œè™Ÿ {order.tableNo}</span>
                                    <span className="text-xs text-gray-500">
                                        {order.timestamp?.toDate().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                                    </span>
                                </div>
                                
                                <div className="p-4 flex-1">
                                    {order.notes && (
                                        <div className="bg-yellow-100 text-yellow-800 text-sm p-2 rounded mb-3">
                                            <i className="fa-solid fa-note-sticky mr-1"></i>å‚™è¨»: {order.notes}
                                        </div>
                                    )}
                                    <ul className="space-y-3">
                                        {order.items.map((item, idx) => (
                                            <li key={idx} className="border-b pb-2 last:border-0">
                                                <div className="flex justify-between font-bold text-gray-800">
                                                    <span>{item.name}</span>
                                                </div>
                                                <div className="text-sm text-gray-500 pl-2 border-l-2 border-gray-200 mt-1">
                                                    {item.specDescription && <div>{item.specDescription}</div>}
                                                    {item.drinkDescription && <div className="text-blue-600">{item.drinkDescription}</div>}
                                                </div>
                                            </li>
                                        ))}
                                    </ul>
                                </div>

                                <div className="p-3 bg-gray-50 border-t flex justify-between items-center">
                                    <span className="font-bold text-gray-600">ç¸½è¨ˆ ${order.total}</span>
                                    <button 
                                        onClick={() => completeOrder(order.id)}
                                        className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded shadow transition"
                                    >
                                        å®Œæˆè¨‚å–®
                                    </button>
                                </div>
                            </div>
                        ))}
                        
                        {orders.length === 0 && (
                            <div className="col-span-full text-center text-gray-400 py-20">
                                <i className="fa-solid fa-mug-hot text-6xl mb-4"></i>
                                <p className="text-xl">ç›®å‰æ²’æœ‰å¾…è™•ç†è¨‚å–®</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // ==========================================
        // 9. ä¸»ç¨‹å¼ App
        // ==========================================
        function App() {
            return (
                <MenuProvider>
                    <MainContent />
                </MenuProvider>
            );
        }

        function MainContent() {
            const { isAdmin, user } = React.useContext(MenuContext);

            // å¦‚æœæœªç™»å…¥ï¼Œé¡¯ç¤ºç™»å…¥ç•«é¢ (ä½¿ç”¨æ‚¨ä¹‹å‰ä¿®å¥½çš„é‚è¼¯)
            if (!user) {
                return <LoginScreen />;
            }

            return (
                <div className="h-full bg-gray-100">
                    <Navbar />
                    {isAdmin ? (
                        <AdminDashboard />
                    ) : (
                        <>
                            <CategoryNav />
                            <CustomerView />
                            <CartSidebar />
                        </>
                    )}
                </div>
            );
        }

        // ç™»å…¥ç•«é¢å…ƒä»¶
        function LoginScreen() {
            const handleGoogleLogin = async () => {
                try {
                    const provider = new GoogleAuthProvider();
                    await signInWithPopup(auth, provider);
                } catch (error) {
                    alert("ç™»å…¥å¤±æ•—: " + error.message);
                }
            };

            const handleAnonymousLogin = async () => {
                try {
                    await signInAnonymously(auth);
                } catch (error) {
                    alert("åŒ¿åç™»å…¥å¤±æ•—: " + error.message);
                }
            };

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-4 bg-gray-100">
                    <div className="bg-white p-8 rounded-lg shadow-xl max-w-sm w-full text-center">
                        <div className="w-20 h-20 bg-orange-500 rounded-full flex items-center justify-center text-white text-3xl font-bold mx-auto mb-6">P</div>
                        <h1 className="text-2xl font-bold text-gray-800 mb-2">æ­¡è¿ä¾†åˆ° PoPo é»é¤</h1>
                        <p className="text-gray-500 mb-8">è«‹é¸æ“‡ç™»å…¥æ–¹å¼ä»¥é–‹å§‹é»é¤</p>
                        
                        <button onClick={handleGoogleLogin} className="w-full bg-blue-600 text-white font-bold py-3 rounded-lg mb-3 shadow hover:bg-blue-700 transition flex items-center justify-center gap-2">
                            <i className="fa-brands fa-google"></i> Google ç™»å…¥ (æ¨è–¦)
                        </button>
                        <button onClick={handleAnonymousLogin} className="w-full bg-gray-200 text-gray-700 font-bold py-3 rounded-lg hover:bg-gray-300 transition">
                            è¨ªå®¢ç›´æ¥é»é¤
                        </button>
                    </div>
                </div>
            );
        }

        // å•Ÿå‹• React
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
